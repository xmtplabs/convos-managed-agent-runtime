{
  "title": "Convos Pool Manager",
  "description": "Pool health, claim performance, and provider reliability.",
  "widgets": [
    {
      "id": 1001,
      "definition": {
        "title": "Pool Instances by Status (all envs)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "idle", "data_source": "metrics", "query": "sum:convos.pool.pool.idle{*} by {env}" },
              { "name": "starting", "data_source": "metrics", "query": "sum:convos.pool.pool.starting{*} by {env}" },
              { "name": "claimed", "data_source": "metrics", "query": "sum:convos.pool.pool.claimed{*} by {env}" },
              { "name": "crashed", "data_source": "metrics", "query": "sum:convos.pool.pool.crashed{*} by {env}" },
              { "name": "dead", "data_source": "metrics", "query": "sum:convos.pool.pool.dead{*} by {env}" }
            ],
            "formulas": [
              { "alias": "Idle", "formula": "idle" },
              { "alias": "Starting", "formula": "starting" },
              { "alias": "Claimed", "formula": "claimed" },
              { "alias": "Crashed", "formula": "crashed" },
              { "alias": "Dead", "formula": "dead" }
            ],
            "style": { "palette": "dog_classic", "line_type": "solid", "line_width": "normal" },
            "display_type": "area"
          }
        ]
      },
      "layout": { "x": 0, "y": 0, "width": 6, "height": 3 }
    },
    {
      "id": 1002,
      "definition": {
        "title": "Tick Duration by Env (ms)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "max", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "query1", "data_source": "metrics", "query": "avg:convos.pool.tick.duration_ms{*} by {env}" }
            ],
            "formulas": [{ "alias": "Tick Duration", "formula": "query1" }],
            "style": { "palette": "dog_classic", "line_type": "solid", "line_width": "normal" },
            "display_type": "line"
          }
        ],
        "markers": [
          { "value": "y = 30000", "display_type": "error dashed" }
        ]
      },
      "layout": { "x": 6, "y": 0, "width": 6, "height": 3 }
    },
    {
      "id": 2001,
      "definition": {
        "title": "Claim Duration by Env (ms)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "max", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "query1", "data_source": "metrics", "query": "avg:convos.pool.claim.duration_ms{*} by {env}" }
            ],
            "formulas": [{ "alias": "Claim Duration", "formula": "query1" }],
            "style": { "palette": "cool", "line_type": "solid", "line_width": "normal" },
            "display_type": "line"
          }
        ],
        "markers": [
          { "value": "y = 15000", "display_type": "error dashed" }
        ]
      },
      "layout": { "x": 0, "y": 3, "width": 4, "height": 2 }
    },
    {
      "id": 2002,
      "definition": {
        "title": "Instance Create Duration by Env (ms)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "max", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "query1", "data_source": "metrics", "query": "avg:convos.pool.instance.create.duration_ms{*} by {env}" }
            ],
            "formulas": [{ "alias": "Create Duration", "formula": "query1" }],
            "style": { "palette": "warm", "line_type": "solid", "line_width": "normal" },
            "display_type": "line"
          }
        ],
        "markers": [
          { "value": "y = 60000", "display_type": "error dashed" }
        ]
      },
      "layout": { "x": 4, "y": 3, "width": 4, "height": 2 }
    },
    {
      "id": 2003,
      "definition": {
        "title": "Health Checks (all envs)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "ok", "data_source": "metrics", "query": "sum:convos.pool.health_check.success{*} by {env}" },
              { "name": "fail", "data_source": "metrics", "query": "sum:convos.pool.health_check.failure{*} by {env}" },
              { "name": "timeout", "data_source": "metrics", "query": "sum:convos.pool.health_check.timeout{*} by {env}" }
            ],
            "formulas": [
              { "alias": "Success", "formula": "ok" },
              { "alias": "Failure", "formula": "fail" },
              { "alias": "Timeout", "formula": "timeout" }
            ],
            "style": { "palette": "semantic", "line_type": "solid", "line_width": "normal" },
            "display_type": "bars"
          }
        ]
      },
      "layout": { "x": 8, "y": 3, "width": 4, "height": 2 }
    },
    {
      "id": 3001,
      "definition": {
        "title": "Provider Latency (ms)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "max", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "orr", "data_source": "metrics", "query": "avg:convos.pool.provider.openrouter.duration_ms{*}" },
              { "name": "am", "data_source": "metrics", "query": "avg:convos.pool.provider.agentmail.duration_ms{*}" },
              { "name": "tx", "data_source": "metrics", "query": "avg:convos.pool.provider.telnyx.duration_ms{*}" },
              { "name": "rp", "data_source": "metrics", "query": "avg:convos.pool.provider.railway.project.duration_ms{*}" },
              { "name": "rs", "data_source": "metrics", "query": "avg:convos.pool.provider.railway.service.duration_ms{*}" },
              { "name": "rd", "data_source": "metrics", "query": "avg:convos.pool.provider.railway.domain.duration_ms{*}" }
            ],
            "formulas": [
              { "alias": "OpenRouter", "formula": "orr" },
              { "alias": "AgentMail", "formula": "am" },
              { "alias": "Telnyx", "formula": "tx" },
              { "alias": "Railway Project", "formula": "rp" },
              { "alias": "Railway Service", "formula": "rs" },
              { "alias": "Railway Domain", "formula": "rd" }
            ],
            "style": { "palette": "dog_classic", "line_type": "solid", "line_width": "normal" },
            "display_type": "line"
          }
        ],
        "markers": [
          { "value": "y = 10000", "display_type": "warning dashed" }
        ]
      },
      "layout": { "x": 0, "y": 5, "width": 6, "height": 3 }
    },
    {
      "id": 3002,
      "definition": {
        "title": "Services Provisioned (all envs)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["sum", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "orr", "data_source": "metrics", "query": "sum:convos.pool.provider.openrouter.provisioned{*} by {env}" },
              { "name": "am", "data_source": "metrics", "query": "sum:convos.pool.provider.agentmail.provisioned{*} by {env}" },
              { "name": "tx", "data_source": "metrics", "query": "sum:convos.pool.provider.telnyx.provisioned{*} by {env}" },
              { "name": "rw", "data_source": "metrics", "query": "sum:convos.pool.provider.railway.provisioned{*} by {env}" }
            ],
            "formulas": [
              { "alias": "OpenRouter Keys", "formula": "orr" },
              { "alias": "AgentMail Inboxes", "formula": "am" },
              { "alias": "Telnyx Phones", "formula": "tx" },
              { "alias": "Railway Projects", "formula": "rw" }
            ],
            "style": { "palette": "dog_classic", "line_type": "solid", "line_width": "normal" },
            "display_type": "bars"
          }
        ]
      },
      "layout": { "x": 6, "y": 5, "width": 6, "height": 3 }
    },
    {
      "id": 4001,
      "definition": {
        "title": "Claim & Create Success (all envs)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["avg", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "claim", "data_source": "metrics", "query": "avg:convos.pool.claim.success{*} by {env}" },
              { "name": "create", "data_source": "metrics", "query": "avg:convos.pool.instance.create.success{*} by {env}" }
            ],
            "formulas": [
              { "alias": "Claim (1=ok, 0=fail)", "formula": "claim" },
              { "alias": "Create (1=ok, 0=fail)", "formula": "create" }
            ],
            "style": { "palette": "semantic", "line_type": "solid", "line_width": "normal" },
            "display_type": "bars"
          }
        ]
      },
      "layout": { "x": 0, "y": 8, "width": 4, "height": 2 }
    },
    {
      "id": 4002,
      "definition": {
        "title": "Provider Rollbacks (all envs)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["sum", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "query1", "data_source": "metrics", "query": "sum:convos.pool.provider.rollback{*} by {failed_step}" }
            ],
            "formulas": [
              { "alias": "Rollbacks", "formula": "query1" }
            ],
            "style": { "palette": "warm", "line_type": "solid", "line_width": "normal" },
            "display_type": "bars"
          }
        ]
      },
      "layout": { "x": 4, "y": 8, "width": 4, "height": 2 }
    },
    {
      "id": 4003,
      "definition": {
        "title": "No Idle â€” Claims Rejected (all envs)",
        "title_size": "16",
        "title_align": "left",
        "show_legend": true,
        "legend_layout": "horizontal",
        "legend_columns": ["sum", "value"],
        "type": "timeseries",
        "requests": [
          {
            "response_format": "timeseries",
            "queries": [
              { "name": "query1", "data_source": "metrics", "query": "sum:convos.pool.claim.no_idle{*} by {env}" }
            ],
            "formulas": [
              { "alias": "No Idle Events", "formula": "query1" }
            ],
            "style": { "palette": "warm", "line_type": "solid", "line_width": "normal" },
            "display_type": "bars"
          }
        ]
      },
      "layout": { "x": 8, "y": 8, "width": 4, "height": 2 }
    }
  ],
  "template_variables": [],
  "layout_type": "ordered",
  "notify_list": [],
  "reflow_type": "fixed"
}
